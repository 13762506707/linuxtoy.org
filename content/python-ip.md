Title: 使用Python查询纯真IP(最新修改，无乱码）
Date: 2009-05-27 10:48
Author: jianlee
Category: Cli
Tags: ip, Python, QQWry.Dat
Slug: python-ip

纯真IP挺全，IP数据库也是中文的，最近由于把一个服务器放到公网上，老是有一堆人用ssh暴力破解，用
DenyHosts 禁止暴力破解之余，还想看看到底这些 IP 是
哪里的（不过基本上都是代理 ^\_^），就找了一个纯真IP的查询脚本。

[纯真IP的格式详解](http://lumaqq.linuxsir.org/article/qqwry_format_detail.html)

在网上找到一个 Python 脚本，修改后在linux下的 UTF-8
环境正常使用了，添加一些注释，使用的时候下载最新的纯真IP库，解压后把
QQWry.Dat 文件放到下面脚本同一个目录下。使用”./脚本名字.py
IP地址"就可以查询了：

感谢 Xu Xiaodong
的帮助，脚本放在这里。如果有什么我能帮到的问题，可以email我。

[Python 查询纯真IP库](http://i.linuxtoy.org/files/pyip.py)

我在 DenyHosts 禁止的IP查询示例：

    for i in `sed -e '/^ALL/!d' /etc/hosts.deny |cut -d' ' -f2`; do /root/查询纯真IP.py $i;done
    122.224.7.146 浙江省绍兴市/电信
    89.163.144.165 俄罗斯/
    211.174.187.161 韩国/首尔
    59.166.120.184 日本/ATHOME网络
    147.231.70.91 捷克/
    85.28.26.66 英国/伦敦大学皇家医学院皇家法医实验鉴定中心
    218.239.223.77 韩国/
    216.146.47.37 美国/加拿大/未知
    122.155.0.62 泰国/ CZ88.NET
    69.31.5.120 美国/
    75.109.170.56 美国/
    69.43.142.150 美国/
    59.109.6.83 北京市/方正宽带
    125.46.248.158 河南省郑州市/网通
    201.17.35.128 巴西/圣保罗
    212.175.84.152 土耳其/
    219.134.242.67 广东省深圳市/电信ADSL
    213.228.142.42 葡萄牙/
    85.17.182.198 荷兰/阿姆斯特丹Leaseweb IDC
    218.77.129.6 海南省/
    61.151.248.152 上海市/电信
    210.210.18.218 印度/ CZ88.NET
    194.171.247.21 荷兰/
    59.57.251.57 福建省厦门市/电信
    218.56.61.114 山东省济南市/网通
    220.130.208.19 台湾省台北市/中华电信数据通信分公司
    201.63.218.70 美国/中部/南部(IANA)
    118.102.25.161 北京市/光环恒通数字技术

    重要：

    此版本有多处问题，最新版本主看：https://linuxtoy.org/archives/python-qqwry.html
    评论中朋友们提出的问题很多，请原谅我不能一一文字回复．代码就算一种回复吧．:-)
